version: '2'

services:
  queue:
    image: rabbitmq:latest
    container_name: Queue
    ports:
      - 5671:5671
      - 5672:5672
    environment:
      - RABBITMQ_HIPE_COMPILE= 1

  web:
    build: Web
    container_name: Web
    ports:
      - 9080:8080
    depends_on:
      - queue
      - draw
      - customer
      - notification
      - bet
    links:
      - queue  

  bet:
    build: BetService
    container_name: Bet
    depends_on:
       - queue
    links:
       - queue

  customer:
    build: Customer
    container_name: Customer
    depends_on:
       - queue
    links:
       - queue   

  draw:
    build: DrawService
    container_name: Draw
    depends_on:
      - queue
    links:
      - queue  

  notification:
    build: NotificationService
    container_name: Notification
    depends_on:
       - queue
       - mail-server
    links:
       - queue
       - mail-server   
       

  mail-server:
    image: mailhog/mailhog
    container_name: Mail
    ports:
       - 1025:1025
       - 8025:8025
